{% extends "dashboard/base.html" %}

{% block content %}
<div class="max-w-6xl mx-auto mt-10 p-6 bg-white shadow rounded-lg">
  <h2 class="text-2xl font-bold text-gray-800 mb-6">
    🗓️ Routine Setup for Grade {{ grade.grade_number }}
  </h2>

  <!-- Subject/Teacher Assign Help -->
  <div class="mb-6">
    <p class="text-sm text-gray-600">
      Select a subject and assign a teacher for each period. Changes will be saved per cell.
    </p>
  </div>

  <!-- Routine Table -->
  <div class="overflow-auto">
    <form method="POST" action="">
      {% csrf_token %}
      <input type="hidden" name="grade_id" value="{{ grade.id }}">

      <table class="min-w-full border border-gray-200 text-sm">
        <thead class="bg-gray-100">
          <tr>
            <th class="px-4 py-2 border text-left">Day / Period</th>
            {% for period in periods %}
              <th class="px-4 py-2 border text-center">Period {{ period }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for day in days %}
          <tr>
            <td class="px-4 py-2 border font-semibold text-gray-700">{{ day }}</td>

            {% for period in periods %}
            <td class="px-2 py-1 border">
              <div class="flex flex-col gap-1">
                <select name="routine_{{ day }}_{{ period }}_subject" class="w-full text-sm border rounded px-2 py-1">
                  <option value="">-- Subject --</option>
                  {% for subject in subjects %}
                    <option value="{{ subject.id }}">{{ subject.name }}</option>
                  {% endfor %}
                </select>
                <select name="routine_{{ day }}_{{ period }}_teacher" class="w-full text-sm border rounded px-2 py-1">
                  <option value="">-- Teacher --</option>
                  {% for teacher in teachers %}
                    <option value="{{ teacher.id }}">{{ teacher.user.first_name }} {{ teacher.user.last_name }}</option>
                  {% endfor %}
                </select>
              </div>
            </td>
            {% endfor %}
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <div class="mt-6 text-right">
        <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition">
          💾 Save Routine
        </button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
